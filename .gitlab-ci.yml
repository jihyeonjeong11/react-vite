image: node:16-stretch

variables:
  YARN_CACHE_FOLDER: $CI_PROJECT_DIR/.yarn

cache:
    key: ${CI_COMMIT_REF_SLUG}
    paths:
      - node_modules/
      - .yarn/
      - yarn.lock
pages: 
  artifacts: 
    paths: 
      - builds
      - build
      - node_modules/
      - .yarn
      - .yarn/
  cache: 
    paths: 
      - .yarn-cache/
  only: 
    - main
  script: 
    - yarn set version berry      <--- get last version
    - yarn set version 3.2.4      <--- then downgrade to a specific version
    - yarn install
    - yarn build
  stage: deploy